<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Control de Gastos</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- Navigation -->
        <nav class="navbar">
            <h1>üí∞ Control de Gastos</h1>
            <ul class="nav-menu">
                <li><a href="#" data-view="dashboard" class="nav-link active">Dashboard</a></li>
                <li><a href="#" data-view="wallet" class="nav-link">Billetera</a></li>
                <li><a href="#" data-view="config" class="nav-link">Configuraci√≥n</a></li>
            </ul>
        </nav>

        <!-- Dashboard View -->
        <div id="dashboard" class="view active">
            <div class="dashboard-header">
                <h2>Dashboard Principal</h2>
                <div class="period-selector">
                    <button class="period-btn active" data-period="all">Todo</button>
                    <button class="period-btn" data-period="month">Este Mes</button>
                    <button class="period-btn" data-period="week">Esta Semana</button>
                </div>
            </div>
            
            <!-- Summary Cards -->
            <div class="summary-cards">
                <div class="card income-card">
                    <div class="card-icon">üìà</div>
                    <div class="card-content">
                        <h3>Ingresos</h3>
                        <p class="amount" id="total-income">$0.00</p>
                        <span class="card-trend" id="income-trend"></span>
                    </div>
                </div>
                <div class="card expense-card">
                    <div class="card-icon">üìâ</div>
                    <div class="card-content">
                        <h3>Gastos</h3>
                        <p class="amount" id="total-expenses">$0.00</p>
                        <span class="card-trend" id="expenses-trend"></span>
                    </div>
                </div>
                <div class="card balance-card">
                    <div class="card-icon">üí∞</div>
                    <div class="card-content">
                        <h3>Balance</h3>
                        <p class="amount" id="balance">$0.00</p>
                        <span class="card-trend" id="balance-trend"></span>
                    </div>
                </div>
                <div class="card transactions-card">
                    <div class="card-icon">üìä</div>
                    <div class="card-content">
                        <h3>Transacciones</h3>
                        <p class="amount" id="total-transactions">0</p>
                        <span class="card-subtitle">Total registradas</span>
                    </div>
                </div>
            </div>

            <!-- Quick Add Transaction -->
            <div class="quick-add">
                <h3>‚ûï Agregar Transacci√≥n R√°pida</h3>
                <form id="quick-add-form">
                    <div class="form-row">
                        <select id="quick-type" required>
                            <option value="">Tipo</option>
                            <option value="ingreso">Ingreso</option>
                            <option value="gasto">Gasto</option>
                        </select>
                        <input type="number" id="quick-amount" placeholder="Valor" step="0.01" required>
                        <select id="quick-category" required>
                            <option value="">Categor√≠a</option>
                        </select>
                        <input type="text" id="quick-description" placeholder="Descripci√≥n" required>
                        <button type="submit" class="btn-primary">Agregar</button>
                    </div>
                </form>
            </div>

            <!-- Charts Section -->
            <div class="charts-grid">
                <!-- Pie Chart for Category Breakdown -->
                <div class="chart-section">
                    <h3>ü•ß Gastos por Categor√≠a</h3>
                    <div class="chart-wrapper">
                        <canvas id="category-pie-chart"></canvas>
                    </div>
                    <div id="category-legend" class="chart-legend"></div>
                </div>

                <!-- Bar Chart for Monthly Overview -->
                <div class="chart-section">
                    <h3>üìä Resumen Mensual</h3>
                    <div class="chart-wrapper">
                        <canvas id="monthly-bar-chart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Line Chart for Trend -->
            <div class="chart-section full-width">
                <h3>üìà Tendencia de Balance</h3>
                <div class="chart-wrapper-wide">
                    <canvas id="trend-line-chart"></canvas>
                </div>
            </div>

            <!-- Recent Transactions -->
            <div class="recent-transactions">
                <div class="section-header">
                    <h3>üïê Transacciones Recientes</h3>
                    <a href="#" class="view-all-link" data-view="wallet">Ver todas ‚Üí</a>
                </div>
                <div id="recent-list"></div>
            </div>
        </div>

        <!-- Wallet View -->
        <div id="wallet" class="view">
            <h2>Billetera Principal de Gastos</h2>
            
            <!-- Filters -->
            <div class="filters">
                <input type="date" id="filter-date-from" placeholder="Desde">
                <input type="date" id="filter-date-to" placeholder="Hasta">
                <select id="filter-type">
                    <option value="">Todos</option>
                    <option value="ingreso">Ingresos</option>
                    <option value="gasto">Gastos</option>
                </select>
                <select id="filter-category">
                    <option value="">Todas las categor√≠as</option>
                </select>
                <button id="apply-filters" class="btn-secondary">Filtrar</button>
                <button id="clear-filters" class="btn-secondary">Limpiar</button>
            </div>

            <!-- Add Transaction Button -->
            <button id="add-transaction-btn" class="btn-primary">‚ûï Nueva Transacci√≥n</button>

            <!-- Transactions List -->
            <div id="transactions-list"></div>
        </div>

        <!-- Configuration View -->
        <div id="config" class="view">
            <h2>Configuraci√≥n</h2>
            
            <!-- Categories Management -->
            <div class="config-section">
                <h3>Gesti√≥n de Categor√≠as</h3>
                <form id="add-category-form">
                    <div class="form-group">
                        <input type="text" id="new-category" placeholder="Nueva categor√≠a" required>
                        <input type="color" id="category-color" value="#3498db">
                        <button type="submit" class="btn-primary">Agregar Categor√≠a</button>
                    </div>
                </form>
                <div id="categories-list"></div>
            </div>

            <!-- Data Management -->
            <div class="config-section">
                <h3>Gesti√≥n de Datos</h3>
                <button id="export-data" class="btn-secondary">üì• Exportar Datos</button>
                <button id="import-data" class="btn-secondary">üì§ Importar Datos</button>
                <input type="file" id="import-file" accept=".json" style="display: none;">
                <button id="clear-data" class="btn-danger">üóëÔ∏è Borrar Todos los Datos</button>
            </div>
        </div>

        <!-- Transaction Modal -->
        <div id="transaction-modal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h2 id="modal-title">Nueva Transacci√≥n</h2>
                <form id="transaction-form">
                    <div class="form-group">
                        <label for="transaction-type">Tipo:</label>
                        <select id="transaction-type" required>
                            <option value="ingreso">Ingreso</option>
                            <option value="gasto">Gasto</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="transaction-date">Fecha:</label>
                        <input type="date" id="transaction-date" required>
                    </div>
                    <div class="form-group">
                        <label for="transaction-amount">Valor:</label>
                        <input type="number" id="transaction-amount" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="transaction-category">Categor√≠a:</label>
                        <select id="transaction-category" required></select>
                    </div>
                    <div class="form-group">
                        <label for="transaction-description">Descripci√≥n:</label>
                        <input type="text" id="transaction-description" required>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn-primary">Guardar</button>
                        <button type="button" id="cancel-transaction" class="btn-secondary">Cancelar</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
    <script>
        // Load Chart.js asynchronously after the page loads
        (function() {
            const script = document.createElement('script');
            script.src = 'https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js';
            script.onload = function() {
                // Dispatch custom event when Chart.js loads
                window.dispatchEvent(new CustomEvent('chartjs-loaded'));
            };
            script.onerror = function() {
                console.log('Chart.js could not be loaded. Charts will display as bars.');
            };
            document.head.appendChild(script);
        })();
    </script>
</body>
</html>
